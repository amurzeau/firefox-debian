From: Mike Hommey <mh+mozilla@glandium.org>
Date: Wed, 11 Mar 2020 12:12:47 +0900
Subject: Bug 1621518 - Fix build errors with -Werror=format-security with GCC.
 r?jgilbert

---
 dom/canvas/ClientWebGLContext.h |  5 +++++
 dom/canvas/WebGLContext.h       | 10 ++++++++++
 2 files changed, 15 insertions(+)

diff --git a/dom/canvas/ClientWebGLContext.h b/dom/canvas/ClientWebGLContext.h
index 2477faee8c0..ea24feb480a 100644
--- a/dom/canvas/ClientWebGLContext.h
+++ b/dom/canvas/ClientWebGLContext.h
@@ -826,10 +826,15 @@ class ClientWebGLContext final : public nsICanvasRenderingContextInternal,
 #ifdef __clang__
 #  pragma clang diagnostic push
 #  pragma clang diagnostic ignored "-Wformat-security"
+#elif defined(__GNUC__)
+#  pragma GCC diagnostic push
+#  pragma GCC diagnostic ignored "-Wformat-security"
 #endif
     text.AppendPrintf(format, args...);
 #ifdef __clang__
 #  pragma clang diagnostic pop
+#elif defined(__GNUC__)
+#  pragma GCC diagnostic pop
 #endif
 
     EnqueueErrorImpl(error, text);
diff --git a/dom/canvas/WebGLContext.h b/dom/canvas/WebGLContext.h
index 5418722976e..988d80ab2c4 100644
--- a/dom/canvas/WebGLContext.h
+++ b/dom/canvas/WebGLContext.h
@@ -398,10 +398,15 @@ class WebGLContext : public VRefCounted, public SupportsWeakPtr<WebGLContext> {
 #ifdef __clang__
 #  pragma clang diagnostic push
 #  pragma clang diagnostic ignored "-Wformat-security"
+#elif defined(__GNUC__)
+#  pragma GCC diagnostic push
+#  pragma GCC diagnostic ignored "-Wformat-security"
 #endif
     text.AppendPrintf(fmt, args...);
 #ifdef __clang__
 #  pragma clang diagnostic pop
+#elif defined(__GNUC__)
+#  pragma GCC diagnostic pop
 #endif
 
     GenerateErrorImpl(err, text);
@@ -1245,10 +1250,15 @@ class WebGLContext : public VRefCounted, public SupportsWeakPtr<WebGLContext> {
 #ifdef __clang__
 #  pragma clang diagnostic push
 #  pragma clang diagnostic ignored "-Wformat-security"
+#elif defined(__GNUC__)
+#  pragma GCC diagnostic push
+#  pragma GCC diagnostic ignored "-Wformat-security"
 #endif
     msg.AppendPrintf(fmt, args...);
 #ifdef __clang__
 #  pragma clang diagnostic pop
+#elif defined(__GNUC__)
+#  pragma GCC diagnostic pop
 #endif
 
     GenerateErrorImpl(0, msg);
